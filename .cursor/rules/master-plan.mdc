---
description: Всегда читать MASTER_PLAN.md для понимания контекста проекта
alwaysApply: true
---

# Главный план проекта

**ВАЖНО**: Перед началом работы над любой задачей ВСЕГДА читай файл `docs/MASTER_PLAN.md`.

Этот файл содержит:
- Единый источник правды для всего проекта gamesCheck (Fish & Chips)
- Текущий статус всех фаз разработки
- Архитектурные решения и их обоснование
- Список завершённых и активных задач
- Важные технические детали и ограничения
- Инструкции для AI агентов

## Правила общения

- **Язык**: Всегда отвечай на русском языке
- **Git коммиты**: Создавай коммиты ТОЛЬКО если пользователь явно об этом просит
- **Не спрашивай разрешения**: Для сложных задач просто продолжай работу

## Порядок действий

1. **Прочитай** `docs/MASTER_PLAN.md` в начале каждого запроса
2. **Убедись**, что твои действия соответствуют текущей фазе проекта
3. **Следуй** архитектурным решениям, описанным в плане
4. **Обновляй** MASTER_PLAN.md при завершении значимых задач
5. **Указывай дату и время** обновления в формате: `Последнее обновление: YYYY-MM-DD HH:MM`

## Важная информация в MASTER_PLAN.md

Файл содержит критически важную информацию о:
- CloudKit конфигурации
- Firebase Authentication
- Push уведомлениях
- Тестировании и TestFlight
- Правилах работы с кодом

## Изменение структуры данных

**КРИТИЧНО**: При любом изменении структуры данных ОБЯЗАТЕЛЬНО обновляй `docs/DATA_DIAGRAM.md`:

### Что считается изменением структуры данных:
- ✅ Добавление/удаление/изменение Core Data entity
- ✅ Добавление/удаление/изменение атрибута (поля)
- ✅ Добавление/удаление/изменение relationship
- ✅ Изменение CloudKit Record Type
- ✅ Миграция данных между Public/Private DB
- ✅ Изменение порядка синхронизации
- ✅ Изменение логики merge (Source of Truth)
- ✅ Добавление/изменение ключевых идентификаторов

### Что нужно обновить в DATA_DIAGRAM.md:
1. **ER-диаграмму** (если изменились entities/relationships)
2. **CloudKit Schema** (если изменилось распределение Public/Private DB)
3. **Поток синхронизации** (если изменился порядок или логика)
4. **Бизнес-процессы** (если изменился flow)
5. **Таблицы** (ключевые идентификаторы, relationships, deletion rules)
6. **Версию и дату** в конце файла

### Пример коммита при изменении структуры:
```
feat: Добавлен атрибут lastSyncedAt в PlayerProfile

Обновлён DATA_DIAGRAM.md:
- Добавлен атрибут lastSyncedAt в ER-диаграмму PlayerProfile
- Обновлена версия: 1.1
- Дата: 2026-02-07
```
